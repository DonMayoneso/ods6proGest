<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Monitoreo Global</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #0a0a0a;
            color: #f0f0f0;
            height: 100vh;
            overflow: hidden;
            cursor: default;
            position: relative;
        }

        /* --- CUBO 3D PRINCIPAL (CENTRO DE LA PANTALLA) --- */
        .main-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100%;
            position: relative;
            z-index: 10;
        }

        .scene {
            width: 200px;
            height: 200px;
            perspective: 1000px;
            margin: 0 auto;
        }

        .cube {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateX(-15deg) rotateY(15deg);
        }

        .face {
            position: absolute;
            width: 200px;
            height: 200px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            color: rgba(255, 255, 255, 0.8);
            background: rgba(30, 30, 30, 0.3);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .face:hover {
            background: rgba(50, 50, 50, 0.5);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .face img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
            z-index: -1;
            pointer-events: none;
            filter: brightness(0.8);
        }

        .front {
            transform: translateZ(100px);
            background: rgba(70, 130, 180, 0.2);
        }

        .back {
            transform: rotateY(180deg) translateZ(100px);
            background: rgba(50, 205, 50, 0.2);
        }

        .right {
            transform: rotateY(90deg) translateZ(100px);
            background: rgba(220, 20, 60, 0.2);
        }

        .left {
            transform: rotateY(-90deg) translateZ(100px);
            background: rgba(186, 85, 211, 0.2);
        }

        .top {
            transform: rotateX(90deg) translateZ(100px);
            background: rgba(255, 215, 0, 0.2);
        }

        .bottom {
            transform: rotateX(-90deg) translateZ(100px);
            background: rgba(240, 128, 128, 0.2);
        }

        .cube-instructions {
            margin-top: 30px;
            padding: 15px;
            background-color: rgba(20, 20, 20, 0.8);
            border-radius: 8px;
            max-width: 500px;
            text-align: center;
            font-size: 0.9rem;
            color: #aaa;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .cube-highlight {
            background-color: rgba(255, 215, 0, 0.3);
            padding: 2px 5px;
            border-radius: 3px;
            color: #ffd700;
        }

        /* --- CONTENEDOR DEL CONTADOR DE AGUA (ESQUINA INFERIOR IZQUIERDA) MÁS GRANDE --- */
        .water-container {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 100;
            width: 240px; /* Aumentado de 180px a 240px */
            background-color: rgba(20, 20, 20, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            font-family: 'VT323', monospace;
            box-shadow: 0 0 15px rgba(0, 158, 226, 0.2);
        }

        .water-header {
            font-size: 1.2em;
            margin-bottom: 15px;
            color: #FFFFFF;
            text-align: center;
            text-shadow: 0 0 5px rgba(0, 158, 226, 0.5);
        }

        /* Gota de agua más grande */
        .water-drop-container {
            width: 140px;
            height: 168px;
            margin: 15px auto;
            position: relative;
            filter: drop-shadow(0 0 10px rgba(0, 158, 226, 0.4));
            animation: float 3s ease-in-out infinite;
        }

        .water-drop-svg {
            width: 100%;
            height: 100%;
            transform-origin: center 70%;
            animation: wobble 4s ease-in-out infinite;
        }

        /* Elementos del SVG */
        .drop-outline {
            fill: none;
            stroke: #4a90e2;
            stroke-width: 20;
            transition: all 0.5s ease;
        }

        .water-fill {
            fill: #009ee2;
            transition: all 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .water-interior {
            fill: #009ee2;
            transition: all 1.2s ease;
        }

        /* Animaciones de la gota */
        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-8px);
            }
        }

        @keyframes wobble {
            0%, 100% {
                transform: rotate(0deg);
            }
            25% {
                transform: rotate(1deg);
            }
            75% {
                transform: rotate(-1deg);
            }
        }

        /* Efectos de brillo */
        .drop-glow {
            filter: drop-shadow(0 0 8px rgba(0, 158, 226, 0.5));
        }

        /* Efecto de destello interno */
        .water-shine {
            animation: shine 6s ease-in-out infinite;
        }

        @keyframes shine {
            0%, 100% {
                opacity: 0.3;
            }
            50% {
                opacity: 0.7;
            }
        }

        /* Barra de progreso más grande */
        .progress-bar-container {
            width: 100%;
            height: 20px;
            background-color: #222;
            border: 1px solid #555;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            border-radius: 10px;
        }

        .progress-bar-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #009ee2, #4a90e2);
            transition: width 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border-radius: 10px;
            position: relative;
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 2s infinite;
            border-radius: 10px;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .water-percentage {
            font-size: 1.5em;
            color: #FFFFFF;
            text-align: center;
            margin: 15px 0;
            text-shadow: 0 0 5px rgba(0, 158, 226, 0.5);
        }

        .water-info {
            color: #aaa;
            font-size: 0.8em;
            text-align: center;
            margin-top: 8px;
        }

        /* Controles más grandes */
        .water-controls {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .water-controls label {
            color: #E0E0E0;
            font-size: 0.9em;
        }

        .water-controls input[type="range"] {
            width: 100%;
            -webkit-appearance: none;
            appearance: none;
            background: #333;
            outline: none;
            height: 8px;
            border: 1px solid #555;
            border-radius: 4px;
        }

        .water-controls input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #E0E0E0;
            border: 2px solid #555;
            cursor: pointer;
            border-radius: 50%;
        }

        .water-controls button {
            background-color: #444;
            color: #E0E0E0;
            border: 1px solid #555;
            padding: 6px 12px;
            cursor: pointer;
            font-family: 'VT323', monospace;
            font-size: 0.9em;
            transition: all 0.2s;
            border-radius: 4px;
        }

        .water-controls button:hover {
            background-color: #555;
            color: #FFF;
        }

        .current-value {
            text-align: center;
            font-size: 1em;
            color: #E0E0E0;
        }

        /* Efecto de ondas en la superficie del agua */
        .water-surface {
            animation: ripple 8s ease-in-out infinite;
        }

        @keyframes ripple {
            0%, 100% {
                transform: scale(1);
                opacity: 0.7;
            }
            50% {
                transform: scale(1.02);
                opacity: 0.9;
            }
        }

        /* Efecto de viaje espacial */
        #spaceTravel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1000;
            display: none;
            overflow: hidden;
        }

        .star {
            position: absolute;
            background-color: white;
            border-radius: 50%;
        }

        .travel-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #4fc3f7;
            text-align: center;
            z-index: 1001;
            text-shadow: 0 0 10px #4fc3f7;
            opacity: 0;
        }
    </style>
</head>
<body>
    <!-- Cubo 3D en el centro de la pantalla -->
    <div class="main-container">
        <div class="scene">
            <div class="cube">
                <div class="face front"><img src="https://via.placeholder.com/200?text=Cara+FRONT" alt="Cara Frontal"></div>
                <div class="face back"><img src="https://via.placeholder.com/200?text=Cara+BACK" alt="Cara Trasera"></div>
                <div class="face right"><img src="https://via.placeholder.com/200?text=Cara+RIGHT" alt="Cara Derecha"></div>
                <div class="face left"><img src="https://via.placeholder.com/200?text=Cara+LEFT" alt="Cara Izquierda"></div>
                <div class="face top"><img src="https://via.placeholder.com/200?text=Cara+TOP" alt="Cara Superior"></div>
                <div class="face bottom"><img src="https://via.placeholder.com/200?text=Cara+BOTTOM" alt="Cara Inferior"></div>
            </div>
        </div>
        <div class="cube-instructions">
            <span class="cube-highlight">Click</span> en una cara para viajar a un mundo. <span class="cube-highlight">Sostener y arrastrar</span> para rotar el cubo.
        </div>
    </div>

    <!-- Contador de agua en la esquina inferior izquierda (más grande) -->
    <div class="water-container">
        <div class="water-header">>>> RECURSOS H2O <<<</div>
        
        <div class="water-drop-container">
            <svg class="water-drop-svg drop-glow" viewBox="0 0 2200 2200" preserveAspectRatio="xMidYMid meet">
                <defs>
                    <!-- Gradiente para el agua interior -->
                    <linearGradient id="waterGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" stop-color="#4fc3f7" stop-opacity="0.9" />
                        <stop offset="70%" stop-color="#009ee2" stop-opacity="1" />
                        <stop offset="100%" stop-color="#0277bd" stop-opacity="1" />
                    </linearGradient>
                    
                    <!-- Clip path para la animación de llenado del interior -->
                    <clipPath id="fillClip">
                        <path d="M1707.22,1290.05c-22.57-97.89-63-197.61-120.18-296.37-40.38-69.74-98.5-153.89-165.8-251.32-90.29-130.71-200.44-290.18-321.23-490.59-120.79,200.39-230.94,359.84-321.22,490.54-67.32,97.45-125.45,181.62-165.84,251.37-57.18,98.76-97.61,198.47-120.17,296.37-25.27,109.62-26.96,213.41-5.03,308.5,33.83,146.68,128.05,276.42,252.05,347.08,101.95,58.1,197.76,94.12,360.21,94.12,133.06,0,247.51-29.91,360.19-94.12,124-70.66,218.23-200.41,252.05-347.08,21.93-95.08,20.24-198.88-5.03-308.5ZM971.75,1916.3c-132.41-12.99-257.5-82.44-321.63-203.04-106.67-199.01-65.06-470.06,68.47-645.81-58.03,186.78-79.4,421.36,17.89,597.09,54.53,95.55,133.07,178.53,383.58,248.49-49.16,7.7-98.89,8.44-148.31,3.27Z"/>
                    </clipPath>
                    
                    <!-- Gradiente para el efecto de brillo -->
                    <linearGradient id="shineGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="white" stop-opacity="0" />
                        <stop offset="50%" stop-color="white" stop-opacity="0.3" />
                        <stop offset="100%" stop-color="white" stop-opacity="0" />
                    </linearGradient>
                </defs>
                
                <!-- Contorno exterior de la gota -->
                <path class="drop-outline" d="M1799.54,1268.77c-24.69-107.1-68.6-215.63-130.51-322.56-42.27-73.01-101.39-158.59-169.84-257.69-99.49-144.03-223.3-323.28-358.32-553.39l-40.86-69.62-40.86,69.62c-135.02,230.08-258.83,409.31-358.31,553.33-68.47,99.12-127.6,184.73-169.88,257.75-61.91,106.93-105.82,215.46-130.5,322.56-28.52,123.74-30.21,241.86-5.03,351.08,39.68,172.01,150.88,324.57,297.46,408.09,112.2,63.96,224.38,106.55,407.12,106.55,150.19,0,279.55-33.86,407.1-106.55,146.59-83.53,257.79-236.09,297.46-408.09,25.19-109.22,23.49-227.34-5.03-351.08ZM1712.25,1598.55c-33.82,146.67-128.05,276.42-252.05,347.08-112.68,64.21-227.13,94.12-360.19,94.12-162.45,0-258.26-36.02-360.21-94.12-124-70.66-218.22-200.4-252.05-347.08-21.93-95.09-20.24-198.88,5.03-308.5,22.56-97.9,62.99-197.61,120.17-296.37,40.39-69.75,98.52-153.92,165.84-251.37,90.28-130.7,200.43-290.15,321.22-490.54,120.79,200.41,230.94,359.88,321.23,490.59,67.3,97.43,125.42,181.58,165.8,251.32,57.18,98.76,97.61,198.48,120.18,296.37,25.27,109.62,26.96,213.42,5.03,308.5Z"/>
                
                <!-- Agua que se llena dentro de la parte azul interior -->
                <rect id="waterFill" class="water-fill water-surface" x="0" y="2200" width="2200" height="2200" 
                      fill="url(#waterGradient)" clip-path="url(#fillClip)" />
                
                <!-- Parte interior azul (se muestra cuando el agua no llega) -->
                <path class="water-interior water-shine" d="M1707.22,1290.05c-22.57-97.89-63-197.61-120.18-296.37-40.38-69.74-98.5-153.89-165.8-251.32-90.29-130.71-200.44-290.18-321.23-490.59-120.79,200.39-230.94,359.84-321.22,490.54-67.32,97.45-125.45,181.62-165.84,251.37-57.18,98.76-97.61,198.47-120.17,296.37-25.27,109.62-26.96,213.41-5.03,308.5,33.83,146.68,128.05,276.42,252.05,347.08,101.95,58.1,197.76,94.12,360.21,94.12,133.06,0,247.51-29.91,360.19-94.12,124-70.66,218.23-200.41,252.05-347.08,21.93-95.08,20.24-198.88-5.03-308.5ZM971.75,1916.3c-132.41-12.99-257.5-82.44-321.63-203.04-106.67-199.01-65.06-470.06,68.47-645.81-58.03,186.78-79.4,421.36,17.89,597.09,54.53,95.55,133.07,178.53,383.58,248.49-49.16,7.7-98.89,8.44-148.31,3.27Z"/>
                
                <!-- Detalle adicional (el tercer path) -->
                <path d="M1120.06,1913.03c-49.16,7.7-98.89,8.44-148.31,3.27-132.41-12.99-257.5-82.44-321.63-203.04-106.67-199.01-65.06-470.06,68.47-645.81-58.03,186.78-79.4,421.36,17.89,597.09,54.53,95.55,133.07,178.53,383.58,248.49Z" fill="#0277bd" opacity="0.7"/>
                
                <!-- Efecto de brillo interno -->
                <ellipse cx="1300" cy="800" rx="400" ry="200" fill="url(#shineGradient)" class="water-shine" />
            </svg>
        </div>

        <div class="progress-bar-container">
            <div class="progress-bar-fill" id="progress-bar-fill"></div>
        </div>

        <div class="water-percentage">AÚN EXISTE UN <span id="water-percent">0</span>% DE AGUA</div>
        <div class="water-info">DATOS EN TIEMPO REAL. ACTUALIZACIÓN: <span id="last-update">--:--</span></div>

        <div class="water-controls">
            <label for="water-level">Simular Nivel:</label>
            <input type="range" id="water-level" min="0" max="100" value="75">
            <div class="current-value" id="current-sim-value">75%</div>
            <button id="update-button">Actualizar</button>
        </div>
    </div>

    <!-- Efecto de viaje espacial -->
    <div id="spaceTravel">
        <div class="travel-text">Viajando a través del espacio...</div>
    </div>

    <script>
        // Script para el contador de agua
        document.addEventListener('DOMContentLoaded', () => {
            const waterPercentDisplay = document.getElementById('water-percent');
            const waterFill = document.getElementById('waterFill');
            const progressBarFill = document.getElementById('progress-bar-fill');
            const lastUpdateDisplay = document.getElementById('last-update');
            
            // Control para simulación
            const waterLevelInput = document.getElementById('water-level');
            const currentSimValue = document.getElementById('current-sim-value');
            const updateButton = document.getElementById('update-button');

            // --- Funciones de actualización ---
            function updateWaterDisplay(percentage) {
                const clampedPercentage = Math.max(0, Math.min(100, percentage));

                // Actualizar texto
                waterPercentDisplay.textContent = clampedPercentage;

                // --- Animación de la gota ---
                // La altura del SVG es 2200
                // 0% = y: 2200 (completamente abajo)
                // 100% = y: 0 (completamente arriba)
                const yPosition = 2200 - (2200 * (clampedPercentage / 100));
                waterFill.setAttribute('y', yPosition);

                // Animación de la barra de progreso
                progressBarFill.style.width = `${clampedPercentage}%`;

                // Actualizar la fecha y hora
                const now = new Date();
                const timeString = now.toLocaleString('es-ES', { 
                    hour: '2-digit', minute: '2-digit'
                });
                lastUpdateDisplay.textContent = timeString;
            }

            // --- Simulación inicial y manejo de eventos ---
            let currentWaterPercentage = 75; 

            waterLevelInput.addEventListener('input', () => {
                currentSimValue.textContent = `${waterLevelInput.value}%`;
            });

            updateButton.addEventListener('click', () => {
                currentWaterPercentage = parseInt(waterLevelInput.value);
                updateWaterDisplay(currentWaterPercentage);
            });

            // Inicializar con animación
            setTimeout(() => {
                updateWaterDisplay(currentWaterPercentage);
            }, 500);
            
            // Simular una actualización automática cada 10 segundos (opcional)
            setInterval(() => {
                // Pequeña variación aleatoria para simular datos en tiempo real
                const randomVariation = Math.random() * 2 - 1; // -1 a +1
                const newPercentage = Math.max(0, Math.min(100, currentWaterPercentage + randomVariation));
                
                // Solo actualizar si hay un cambio significativo
                if (Math.abs(newPercentage - currentWaterPercentage) > 0.5) {
                    currentWaterPercentage = newPercentage;
                    waterLevelInput.value = Math.round(currentWaterPercentage);
                    currentSimValue.textContent = `${Math.round(currentWaterPercentage)}%`;
                    updateWaterDisplay(currentWaterPercentage);
                }
            }, 10000);
        });

        // Script para el cubo 3D
        document.addEventListener('DOMContentLoaded', function() {
            const cube = document.querySelector('.cube');
            const scene = document.querySelector('.scene');
            const body = document.body;
            const spaceTravel = document.getElementById('spaceTravel');
            const travelText = document.querySelector('.travel-text');
            
            let isDragging = false;
            let previousMouseX = 0;
            let previousMouseY = 0;
            let rotateX = -15;
            let rotateY = 15;

            let animationFrameId = null;
            const autoRotationSpeedX = 0.20;
            const autoRotationSpeedY = 0.25;

            // Variables para detectar clic vs arrastre
            let hasMoved = false;
            let startMouseX = 0;
            let startMouseY = 0;
            let clickedTarget = null;
            const moveThreshold = 5;

            function applyRotation() {
                cube.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
            }

            function animateRotation() {
                if (!isDragging) {
                    rotateX += autoRotationSpeedX;
                    rotateY += autoRotationSpeedY;
                    applyRotation();
                }
                animationFrameId = requestAnimationFrame(animateRotation);
            }

            applyRotation();
            animateRotation();

            // Función para mostrar efecto de viaje espacial y redirigir
            function travelToWorld(faceElement) {
                let faceName = 'Cara desconocida';
                if (faceElement.classList.contains('front')) faceName = 'Frontal';
                if (faceElement.classList.contains('back')) faceName = 'Trasera';
                if (faceElement.classList.contains('left')) faceName = 'Izquierda';
                if (faceElement.classList.contains('right')) faceName = 'Derecha';
                if (faceElement.classList.contains('top')) faceName = 'Superior';
                if (faceElement.classList.contains('bottom')) faceName = 'Inferior';
                
                // Mostrar efecto de viaje espacial
                spaceTravel.style.display = 'block';
                
                // Crear estrellas para el efecto
                createStars();
                
                // Animación del texto
                setTimeout(() => {
                    travelText.style.opacity = 1;
                    travelText.style.transition = 'opacity 1s';
                }, 500);
                
                // Redirigir después de la animación
                setTimeout(() => {
                    window.location.href = 'nave.html?cara=' + faceName;
                }, 3000);
            }

            // Función para crear estrellas en movimiento
            function createStars() {
                const starsContainer = spaceTravel;
                
                // Limpiar estrellas anteriores
                starsContainer.innerHTML = '';
                starsContainer.appendChild(travelText);
                
                // Crear nuevas estrellas
                for (let i = 0; i < 150; i++) {
                    const star = document.createElement('div');
                    star.classList.add('star');
                    
                    // Tamaño aleatorio
                    const size = Math.random() * 3;
                    star.style.width = size + 'px';
                    star.style.height = size + 'px';
                    
                    // Posición inicial aleatoria
                    star.style.left = Math.random() * 100 + '%';
                    star.style.top = Math.random() * 100 + '%';
                    
                    // Animación de movimiento (efecto de viaje a alta velocidad)
                    star.style.animation = `moveStar ${1 + Math.random() * 2}s linear infinite`;
                    
                    starsContainer.appendChild(star);
                }
                
                // Definir la animación de las estrellas
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes moveStar {
                        0% {
                            transform: translateZ(0) scale(1);
                            opacity: 1;
                        }
                        100% {
                            transform: translateZ(1000px) scale(0);
                            opacity: 0;
                        }
                    }
                `;
                document.head.appendChild(style);
            }

            // Manejadores de eventos MOUSE
            scene.addEventListener('mousedown', function(e) {
                isDragging = true;
                hasMoved = false;
                startMouseX = e.clientX;
                startMouseY = e.clientY;
                previousMouseX = e.clientX;
                previousMouseY = e.clientY;
                clickedTarget = e.target.closest('.face');
                
                body.classList.add('dragging');
                e.preventDefault();
            });
            
            document.addEventListener('mousemove', function(e) {
                if (!isDragging) return;

                const totalDeltaX = Math.abs(e.clientX - startMouseX);
                const totalDeltaY = Math.abs(e.clientY - startMouseY);
                if (totalDeltaX > moveThreshold || totalDeltaY > moveThreshold) {
                    hasMoved = true;
                }
                
                const deltaX = e.clientX - previousMouseX;
                const deltaY = e.clientY - previousMouseY;
                
                rotateY += deltaX * 0.5;
                rotateX -= deltaY * 0.5;
                
                applyRotation();
                
                previousMouseX = e.clientX;
                previousMouseY = e.clientY;
            });
            
            document.addEventListener('mouseup', function() {
                isDragging = false;
                body.classList.remove('dragging');

                if (!hasMoved && clickedTarget) {
                    travelToWorld(clickedTarget);
                }
                clickedTarget = null;
            });
            
            document.addEventListener('mouseleave', function() {
                isDragging = false;
                body.classList.remove('dragging');
                clickedTarget = null;
            });
            
            // Manejadores TÁCTILES
            scene.addEventListener('touchstart', function(e) {
                isDragging = true;
                hasMoved = false;
                
                const touch = e.touches[0];
                startMouseX = touch.clientX;
                startMouseY = touch.clientY;
                previousMouseX = touch.clientX;
                previousMouseY = touch.clientY;
                clickedTarget = e.target.closest('.face');
                
                body.classList.add('dragging');
            });
            
            document.addEventListener('touchmove', function(e) {
                if (!isDragging) return;

                const touch = e.touches[0];
                const totalDeltaX = Math.abs(touch.clientX - startMouseX);
                const totalDeltaY = Math.abs(touch.clientY - startMouseY);
                
                if (totalDeltaX > moveThreshold || totalDeltaY > moveThreshold) {
                    hasMoved = true;
                    e.preventDefault();
                }

                const deltaX = touch.clientX - previousMouseX;
                const deltaY = touch.clientY - previousMouseY;
                
                rotateY += deltaX * 0.5;
                rotateX -= deltaY * 0.5;
                
                applyRotation();
                
                previousMouseX = touch.clientX;
                previousMouseY = touch.clientY;
            });
            
            document.addEventListener('touchend', function() {
                isDragging = false;
                body.classList.remove('dragging');

                if (!hasMoved && clickedTarget) {
                    travelToWorld(clickedTarget);
                }
                clickedTarget = null;
            });
        });
    </script>
</body>
</html>